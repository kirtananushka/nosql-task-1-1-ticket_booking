CREATE TABLE events
(
    id           BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    title        VARCHAR(50)   NOT NULL,
    date         TIMESTAMP     NOT NULL,
    ticket_price DECIMAL(6, 2) NOT NULL DEFAULT 0
);

CREATE TABLE users
(
    id         BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name  VARCHAR(50) NOT NULL,
    email      VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE tickets
(
    id          BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    user_id     BIGINT      NOT NULL,
    event_id    BIGINT      NOT NULL,
    seat_number INT         NOT NULL,
    category    VARCHAR(50) NOT NULL,
    CONSTRAINT fk_tickets_users FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE,
    CONSTRAINT fk_tickets_events FOREIGN KEY (event_id) REFERENCES events (id) ON DELETE CASCADE,
    CONSTRAINT uq_tickets_event_id_seat_number UNIQUE (event_id, seat_number),
    CONSTRAINT uq_tickets_user_id_event_id_seat_number UNIQUE (user_id, event_id, seat_number)
);

CREATE TABLE user_accounts
(
    id      BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    user_id BIGINT        NOT NULL UNIQUE,
    balance DECIMAL(6, 2) NOT NULL,
    CONSTRAINT fk_user_accounts_users FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE
);

ALTER TABLE events
    ADD CONSTRAINT uq_events_title_date UNIQUE (title, date);

CREATE INDEX idx_tickets_user_id ON tickets (user_id);
CREATE INDEX idx_tickets_event_id ON tickets (event_id);

INSERT INTO events (title, date, ticket_price)
VALUES ('Tbilisi Jazz Festival', '2024-10-10 19:00:00', 80.00),
       ('New Year Gala Concert', '2024-12-31 21:00:00', 120.00),
       ('Sukhishvili Georgian National Ballet', '2024-11-20 18:30:00', 60.00),
       ('Tbilisi Film Festival', '2024-12-05 17:00:00', 50.00),
       ('Open Air Music Festival', '2024-07-15 16:00:00', 75.00),
       ('Wine Tasting Festival', '2024-09-22 14:00:00', 30.00),
       ('ArtGene Festival', '2024-08-08 18:00:00', 40.00),
       ('Tbilisi Book Fair', '2024-06-15 10:00:00', 15.00),
       ('Silk Road International Film Festival', '2024-11-12 18:00:00', 70.00),
       ('Jazz Nights at the Philharmonic', '2024-09-10 20:00:00', 85.00),
       ('Opera Night', '2024-11-22 20:00:00', 110.00),
       ('International Folklore Festival', '2024-08-01 17:00:00', 55.00),
       ('Eristavi Theater Performance', '2024-10-17 19:00:00', 45.00),
       ('Modern Art Exhibition', '2024-09-05 12:00:00', 25.00),
       ('Georgian Wine Gala', '2024-10-22 19:30:00', 95.00),
       ('Outdoor Cinema Night', '2024-07-29 20:00:00', 20.00),
       ('Classical Music Concert', '2024-10-14 19:30:00', 100.00),
       ('National Museum Special Exhibition', '2024-11-02 11:00:00', 25.00),
       ('Tbilisi Design Week', '2024-09-12 14:00:00', 35.00),
       ('Tbilisi Fashion Week', '2024-10-18 17:00:00', 90.00);

INSERT INTO users (first_name, last_name, email)
VALUES ('Giorgi', 'Bagrationi', 'giorgi.bagrationi@example.com'),
       ('Nino', 'Chkheidze', 'nino.chkheidze@example.com'),
       ('Tornike', 'Javakhishvili', 'tornike.javakhishvili@example.com'),
       ('Salome', 'Mekvabishvili', 'salome.mekvabishvili@example.com'),
       ('Tamar', 'Tsereteli', 'tamar.tsereteli@example.com'),
       ('Levan', 'Gelashvili', 'levan.gelashvili@example.com'),
       ('Ana', 'Tsintsadze', 'ana.tsintsadze@example.com'),
       ('Davit', 'Abashidze', 'davit.abashidze@example.com'),
       ('Eka', 'Kiknadze', 'eka.kiknadze@example.com'),
       ('Guram', 'Shalikashvili', 'guram.shalikashvili@example.com'),
       ('Maia', 'Tchumburidze', 'maia.tchumburidze@example.com'),
       ('Shalva', 'Metreveli', 'shalva.metreveli@example.com'),
       ('Sopho', 'Lomidze', 'sopho.lomidze@example.com'),
       ('Nikoloz', 'Samkharadze', 'nikoloz.samkharadze@example.com'),
       ('Elene', 'Javakhishvili', 'elene.javakhishvili@example.com'),
       ('Beka', 'Sikharulidze', 'beka.sikharulidze@example.com'),
       ('Tinatin', 'Chachua', 'tinatin.chachua@example.com'),
       ('Zura', 'Melkadze', 'zura.melkadze@example.com'),
       ('Natia', 'Tabukashvili', 'natia.tabukashvili@example.com'),
       ('Sandro', 'Kutateladze', 'sandro.kutateladze@example.com'),
       ('Gvantsa', 'Baratashvili', 'gvantsa.baratashvili@example.com'),
       ('Ramaz', 'Gvaramadze', 'ramaz.gvaramadze@example.com'),
       ('Mariam', 'Gelovani', 'mariam.gelovani@example.com'),
       ('Revaz', 'Gogitidze', 'revaz.gogitidze@example.com'),
       ('Nia', 'Beridze', 'nia.beridze@example.com'),
       ('Zuriko', 'Tskhvedadze', 'zuriko.tskhvedadze@example.com'),
       ('Ketevan', 'Abuladze', 'ketevan.abuladze@example.com'),
       ('Giorgi', 'Kandelaki', 'giorgi.kandelaki@example.com'),
       ('Sophiko', 'Shalvashvili', 'sophiko.shalvashvili@example.com'),
       ('Irakli', 'Nozadze', 'irakli.nozadze@example.com'),
       ('Tamuna', 'Iashvili', 'tamuna.iashvili@example.com'),
       ('Lasha', 'Chitanava', 'lasha.chitanava@example.com'),
       ('Khatuna', 'Gelashvili', 'khatuna.gelashvili@example.com'),
       ('Dato', 'Ghoghoberidze', 'dato.ghoghoberidze@example.com'),
       ('Shota', 'Khutsishvili', 'shota.khutsishvili@example.com'),
       ('Ana', 'Dolidze', 'ana.dolidze@example.com'),
       ('Merab', 'Bukia', 'merab.bukia@example.com'),
       ('Nia', 'Gotsiridze', 'nia.gotsiridze@example.com'),
       ('Luka', 'Aptsiauri', 'luka.aptsiauri@example.com'),
       ('Saba', 'Maisuradze', 'saba.maisuradze@example.com'),
       ('Kakha', 'Kandelaki', 'kakha.kandelaki@example.com'),
       ('Sopho', 'Akhvlediani', 'sopho.akhvlediani@example.com'),
       ('Giorgi', 'Iakobashvili', 'giorgi.iakobashvili@example.com'),
       ('Eliso', 'Kutateladze', 'eliso.kutateladze@example.com'),
       ('Zviad', 'Khutsishvili', 'zviad.khutsishvili@example.com'),
       ('Irina', 'Kiladze', 'irina.kiladze@example.com'),
       ('Gela', 'Gogichaishvili', 'gela.gogichaishvili@example.com'),
       ('Nana', 'Burjanadze', 'nana.burjanadze@example.com'),
       ('Mariam', 'Giorgadze', 'mariam.giorgadze@example.com'),
       ('Zura', 'Papashvili', 'zura.papashvili@example.com');

INSERT INTO tickets (user_id, event_id, seat_number, category)
VALUES (1, 1, 5, 'VIP'),
       (2, 2, 12, 'STANDARD'),
       (3, 3, 8, 'STANDARD'),
       (4, 4, 4, 'VIP'),
       (5, 5, 14, 'STANDARD'),
       (6, 6, 22, 'STANDARD'),
       (7, 7, 2, 'VIP'),
       (8, 8, 6, 'STANDARD'),
       (9, 9, 17, 'STANDARD'),
       (10, 10, 21, 'STANDARD'),
       (11, 11, 15, 'VIP'),
       (12, 12, 9, 'STANDARD'),
       (13, 13, 19, 'STANDARD'),
       (14, 14, 7, 'STANDARD'),
       (15, 15, 3, 'VIP'),
       (16, 16, 10, 'STANDARD'),
       (17, 17, 18, 'STANDARD'),
       (18, 18, 12, 'STANDARD'),
       (19, 19, 13, 'VIP'),
       (20, 20, 1, 'VIP'),
       (21, 1, 11, 'STANDARD'),
       (22, 2, 5, 'STANDARD'),
       (23, 3, 6, 'VIP'),
       (24, 4, 9, 'STANDARD'),
       (25, 5, 15, 'VIP'),
       (26, 6, 23, 'STANDARD'),
       (27, 7, 24, 'VIP'),
       (28, 8, 13, 'STANDARD'),
       (29, 9, 25, 'STANDARD'),
       (30, 10, 2, 'STANDARD'),
       (31, 11, 14, 'VIP'),
       (32, 12, 7, 'STANDARD'),
       (33, 13, 21, 'STANDARD'),
       (34, 14, 12, 'STANDARD'),
       (35, 15, 9, 'VIP'),
       (36, 16, 1, 'VIP'),
       (37, 17, 16, 'STANDARD'),
       (38, 18, 10, 'STANDARD'),
       (39, 19, 6, 'VIP'),
       (40, 20, 11, 'STANDARD'),
       (41, 1, 15, 'STANDARD'),
       (42, 2, 4, 'VIP'),
       (43, 3, 17, 'STANDARD'),
       (44, 4, 3, 'STANDARD'),
       (45, 5, 16, 'VIP'),
       (46, 6, 2, 'STANDARD'),
       (47, 7, 19, 'VIP'),
       (48, 8, 1, 'VIP'),
       (49, 9, 7, 'STANDARD'),
       (50, 10, 9, 'STANDARD'),
       (1, 11, 6, 'VIP'),
       (2, 12, 20, 'STANDARD'),
       (3, 13, 18, 'STANDARD'),
       (4, 14, 5, 'VIP'),
       (5, 15, 11, 'STANDARD'),
       (6, 16, 12, 'STANDARD'),
       (7, 17, 3, 'VIP'),
       (8, 18, 21, 'STANDARD'),
       (9, 19, 4, 'STANDARD'),
       (10, 20, 2, 'STANDARD'),
       (11, 1, 18, 'VIP'),
       (12, 2, 14, 'STANDARD'),
       (13, 3, 10, 'VIP'),
       (14, 4, 7, 'STANDARD'),
       (15, 5, 17, 'VIP'),
       (16, 6, 9, 'STANDARD'),
       (17, 7, 12, 'VIP'),
       (18, 8, 3, 'STANDARD'),
       (19, 9, 4, 'STANDARD'),
       (20, 10, 10, 'VIP'),
       (1, 11, 17, 'STANDARD'),
       (12, 12, 19, 'STANDARD'),
       (23, 13, 22, 'VIP'),
       (34, 14, 15, 'STANDARD'),
       (45, 15, 13, 'VIP'),
       (6, 16, 16, 'STANDARD'),
       (17, 17, 8, 'STANDARD'),
       (28, 5, 22, 'VIP'),
       (39, 5, 24, 'STANDARD'),
       (50, 5, 23, 'VIP');


INSERT INTO user_accounts (user_id, balance)
VALUES (1, 250.00),
       (2, 180.00),
       (3, 75.00),
       (4, 100.00),
       (5, 150.00),
       (6, 200.00),
       (7, 90.00),
       (8, 300.00),
       (9, 400.00),
       (10, 220.00),
       (11, 175.00),
       (12, 110.00),
       (13, 95.00),
       (14, 160.00),
       (15, 245.00),
       (16, 190.00),
       (17, 85.00),
       (18, 125.00),
       (19, 310.00),
       (20, 405.00),
       (21, 225.00),
       (22, 195.00),
       (23, 275.00),
       (24, 185.00),
       (25, 155.00),
       (26, 350.00),
       (27, 180.00),
       (28, 95.00),
       (29, 210.00),
       (30, 270.00),
       (31, 320.00),
       (32, 175.00),
       (33, 105.00),
       (34, 245.00),
       (35, 280.00),
       (36, 130.00),
       (37, 190.00),
       (38, 220.00),
       (39, 85.00),
       (40, 400.00),
       (41, 150.00),
       (42, 260.00),
       (43, 235.00),
       (44, 110.00),
       (45, 115.00),
       (46, 360.00),
       (47, 140.00),
       (48, 165.00),
       (49, 325.00),
       (50, 185.00);

